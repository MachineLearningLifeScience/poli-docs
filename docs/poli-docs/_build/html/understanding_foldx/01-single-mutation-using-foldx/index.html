

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Computing the energy of a protein and a single mutation &#8212; Documentation for poli and poli-baselines</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'understanding_foldx/01-single-mutation-using-foldx/index';</script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Installing foldx" href="../00-installing-foldx.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/MLLS_concept_color.png" class="logo__image only-light" alt="Documentation for poli and poli-baselines - Home"/>
    <script>document.write(`<img src="../../_static/MLLS_concept_color.png" class="logo__image only-dark" alt="Documentation for poli and poli-baselines - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    poli ðŸ§ª: a library of discrete objective functions
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/getting_started.html">Getting started</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/the_basics/intro_to_poli.html">What is poli?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/the_basics/defining_an_observer.html">Defining an observer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/the_basics/isolation.html">Isolating black box objective functions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/optimization_examples/protein-stability-foldx/optimizing_protein_stability.html">Optimizing protein stability using random mutations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Objective functions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/objective_repository/all_objectives.html">All objective functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/objective_repository/white_noise.html">White Noise objective function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/objective_repository/aloha.html">Aloha objective function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/objective_repository/toy_continuous_problems.html">Toy continuous objective functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/objective_repository/rdkit_qed.html">Quantitative Estimate of Druglikeness (QED)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/objective_repository/rdkit_logp.html">Log-solubility (logP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/objective_repository/dockstring.html">dockstring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/objective_repository/drd3_docking.html">DRD3 docking (using TDC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/objective_repository/penalized_logp_lambo.html">Penalized logP (using <code class="docutils literal notranslate"><span class="pre">lambo</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/objective_repository/sa_tdc.html">Synthetic Accessibility (using TDC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/objective_repository/foldx_stability.html">Protein stability (using <code class="docutils literal notranslate"><span class="pre">foldx</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/objective_repository/foldx_sasa.html">Protein solvent accessibility (using <code class="docutils literal notranslate"><span class="pre">foldx</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli/objective_repository/RaSP.html">Rapid Stability Predictions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Optimizers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../using_poli_baselines/random_mutations.html">Random mutations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli_baselines/cma_es.html">CMA-ES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli_baselines/bayesian_optimization.html">Bayesian Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_poli_baselines/line_bayesian_optimization.html">Line Bayesian Optimization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../contributing/a_new_problem.html">Adding a new problem to the repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/a_new_solver.html">Adding a new optimizer to <code class="docutils literal notranslate"><span class="pre">poli-baselines</span></code></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api.html">API documentation for poli</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/poli.core.html">poli.core</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/poli.core.abstract_black_box.html">poli.core.abstract_black_box</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/poli.core.abstract_problem_factory.html">poli.core.abstract_problem_factory</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.core.chemistry.html">poli.core.chemistry</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.core.chemistry.tdc_black_box.html">poli.core.chemistry.tdc_black_box</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/poli.core.exceptions.html">poli.core.exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/poli.core.multi_objective_black_box.html">poli.core.multi_objective_black_box</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/poli.core.problem_setup_information.html">poli.core.problem_setup_information</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.core.proteins.html">poli.core.proteins</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.core.proteins.foldx_black_box.html">poli.core.proteins.foldx_black_box</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/poli.core.registry.html">poli.core.registry</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.core.util.html">poli.core.util</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.core.util.abstract_observer.html">poli.core.util.abstract_observer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.core.util.alignment.html">poli.core.util.alignment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.core.util.batch.html">poli.core.util.batch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.core.util.chemistry.html">poli.core.util.chemistry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.core.util.external_observer.html">poli.core.util.external_observer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.core.util.files.html">poli.core.util.files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.core.util.inter_process_communication.html">poli.core.util.inter_process_communication</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.core.util.objective_management.html">poli.core.util.objective_management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.core.util.observer_wrapper.html">poli.core.util.observer_wrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.core.util.proteins.html">poli.core.util.proteins</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.core.util.seeding.html">poli.core.util.seeding</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/poli.objective_factory.html">poli.objective_factory</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.html">poli.objective_repository</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.aloha.html">poli.objective_repository.aloha</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.aloha.register.html">poli.objective_repository.aloha.register</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.dockstring.html">poli.objective_repository.dockstring</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.dockstring.register.html">poli.objective_repository.dockstring.register</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.drd3_docking.html">poli.objective_repository.drd3_docking</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.drd3_docking.register.html">poli.objective_repository.drd3_docking.register</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.foldx_rfp_lambo.html">poli.objective_repository.foldx_rfp_lambo</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.foldx_rfp_lambo.register.html">poli.objective_repository.foldx_rfp_lambo.register</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.foldx_sasa.html">poli.objective_repository.foldx_sasa</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.foldx_sasa.register.html">poli.objective_repository.foldx_sasa.register</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.foldx_stability.html">poli.objective_repository.foldx_stability</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.foldx_stability.register.html">poli.objective_repository.foldx_stability.register</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.foldx_stability_and_sasa.html">poli.objective_repository.foldx_stability_and_sasa</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.foldx_stability_and_sasa.register.html">poli.objective_repository.foldx_stability_and_sasa.register</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.gfp_cbas.html">poli.objective_repository.gfp_cbas</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.gfp_cbas.abstract_vae_wrapper.html">poli.objective_repository.gfp_cbas.abstract_vae_wrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.gfp_cbas.cbas_alphabet_preprocessing.html">poli.objective_repository.gfp_cbas.cbas_alphabet_preprocessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.gfp_cbas.cbas_wrapper.html">poli.objective_repository.gfp_cbas.cbas_wrapper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.gfp_cbas.gfp_gp.html">poli.objective_repository.gfp_cbas.gfp_gp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.gfp_cbas.make_vae.html">poli.objective_repository.gfp_cbas.make_vae</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.gfp_cbas.register.html">poli.objective_repository.gfp_cbas.register</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.gfp_select.html">poli.objective_repository.gfp_select</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.gfp_select.register.html">poli.objective_repository.gfp_select.register</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.penalized_logp_lambo.html">poli.objective_repository.penalized_logp_lambo</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.penalized_logp_lambo.register.html">poli.objective_repository.penalized_logp_lambo.register</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.rasp.html">poli.objective_repository.rasp</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.rasp.register.html">poli.objective_repository.rasp.register</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.rdkit_logp.html">poli.objective_repository.rdkit_logp</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.rdkit_logp.register.html">poli.objective_repository.rdkit_logp.register</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.rdkit_qed.html">poli.objective_repository.rdkit_qed</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.rdkit_qed.register.html">poli.objective_repository.rdkit_qed.register</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.rfp_foldx_stability_and_sasa.html">poli.objective_repository.rfp_foldx_stability_and_sasa</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.rfp_foldx_stability_and_sasa.register.html">poli.objective_repository.rfp_foldx_stability_and_sasa.register</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.sa_tdc.html">poli.objective_repository.sa_tdc</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.sa_tdc.register.html">poli.objective_repository.sa_tdc.register</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.super_mario_bros.html">poli.objective_repository.super_mario_bros</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.super_mario_bros.level_utils.html">poli.objective_repository.super_mario_bros.level_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.super_mario_bros.model.html">poli.objective_repository.super_mario_bros.model</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.toy_continuous_problem.html">poli.objective_repository.toy_continuous_problem</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.toy_continuous_problem.definitions.html">poli.objective_repository.toy_continuous_problem.definitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.toy_continuous_problem.register.html">poli.objective_repository.toy_continuous_problem.register</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.toy_continuous_problem.toy_continuous_problem.html">poli.objective_repository.toy_continuous_problem.toy_continuous_problem</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/poli.objective_repository.white_noise.html">poli.objective_repository.white_noise</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/poli.objective_repository.white_noise.register.html">poli.objective_repository.white_noise.register</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/poli.objective.html">poli.objective</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../bibliography.html">References</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix: Understanding foldx</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00-installing-foldx.html">Installing <code class="docutils literal notranslate"><span class="pre">foldx</span></code></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Computing the energy of a protein and a single mutation</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/MachineLearningLifeScience/protein-optimization-docs" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/MachineLearningLifeScience/protein-optimization-docs/issues/new?title=Issue%20on%20page%20%2Funderstanding_foldx/01-single-mutation-using-foldx/index.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/understanding_foldx/01-single-mutation-using-foldx/index.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Computing the energy of a protein and a single mutation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-folders-and-files">Setting up folders and files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-a-pdb-file">Downloading a <code class="docutils literal notranslate"><span class="pre">PDB</span></code> file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#repairing-the-file">Repairing the file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parsing-the-repaired-wildtype">Parsing the repaired wildtype</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-mutations">Defining mutations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-mutation-s-energy">Computing the mutationâ€™s energy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-sasa-score">Computing the SASA score</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="computing-the-energy-of-a-protein-and-a-single-mutation">
<h1>Computing the energy of a protein and a single mutation<a class="headerlink" href="#computing-the-energy-of-a-protein-and-a-single-mutation" title="Permalink to this heading">#</a></h1>
<p>In this tutorial we familiarize ourselves with <code class="docutils literal notranslate"><span class="pre">foldx</span></code>, and how to e.g. measure the stability of a wild type and a single mutation of it.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We assume that you have already installed foldx, and that you know where its binaries are located.</p>
<p>If you need a refresher/want to install it, <a class="reference internal" href="../00-installing-foldx.html"><span class="doc std std-doc">check the previous chapter here</span></a>.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Python prerequisites </p>
<p>This code depends only on <code class="docutils literal notranslate"><span class="pre">biopython</span></code> and <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. Make sure to install them:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>biopython<span class="w"> </span>pandas
</pre></div>
</div>
</div>
<p>This tutorial is heavily inspired by how <a class="reference external" href="https://github.com/samuelstanton/lambo">LaMBO</a> uses <code class="docutils literal notranslate"><span class="pre">foldx</span></code>.</p>
<section id="setting-up-folders-and-files">
<h2>Setting up folders and files<a class="headerlink" href="#setting-up-folders-and-files" title="Permalink to this heading">#</a></h2>
<p>Letâ€™s start by setting up some environment variables that will be essential. <strong>FoldX works by reading and creating several files</strong>, so we need to set up path variables to be able to</p>
<ol class="arabic simple">
<li><p>Copy some essentials from the foldx files (namely, the <code class="docutils literal notranslate"><span class="pre">rotabase.txt</span></code> file)</p></li>
<li><p>Create a working directory where foldx will put all the files it wants to create.</p></li>
</ol>
<p>This notebook assumes that your <code class="docutils literal notranslate"><span class="pre">foldx</span></code> files are inside to your home directory, i.e. we expect that</p>
<ul class="simple">
<li><p>the binary <code class="docutils literal notranslate"><span class="pre">~/foldx/foldx</span></code> exists, and</p></li>
<li><p>the file <code class="docutils literal notranslate"><span class="pre">~/foldx/rotabase.txt</span></code> exists.</p></li>
</ul>
<p>These two can be found in your <code class="docutils literal notranslate"><span class="pre">foldx</span></code> installation. You might need to rename the binary.</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">shutil</span>

<span class="c1"># The path to the folder where the FoldX files are located</span>
<span class="n">PATH_TO_FOLDX_FILES</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">home</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;foldx&quot;</span>

<span class="c1"># The path to where this notebook is located</span>
<span class="n">THIS_DIR</span> <span class="o">=</span> <span class="n">Path</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

<span class="c1"># Creating a working directory for foldx&#39;s files</span>
<span class="n">WORKING_DIR</span> <span class="o">=</span> <span class="n">THIS_DIR</span> <span class="o">/</span> <span class="s2">&quot;tmp&quot;</span>
<span class="n">WORKING_DIR</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Copying the rotabase.txt file to the working directory</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">PATH_TO_FOLDX_FILES</span> <span class="o">/</span> <span class="s2">&quot;rotabase.txt&quot;</span><span class="p">,</span> <span class="n">WORKING_DIR</span> <span class="o">/</span> <span class="s2">&quot;rotabase.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="downloading-a-pdb-file">
<h2>Downloading a <code class="docutils literal notranslate"><span class="pre">PDB</span></code> file<a class="headerlink" href="#downloading-a-pdb-file" title="Permalink to this heading">#</a></h2>
<p>In this example, we use a protein responsible for transporting oxigen in sperm whales (called <code class="docutils literal notranslate"><span class="pre">101m</span></code>). You could download it <a class="reference external" href="https://www.rcsb.org/structure/101M">by hand from pdb</a>, but in this notebook we will use Python, and we will download it directly on the working directory at <code class="docutils literal notranslate"><span class="pre">./tmp</span></code>:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">urllib.request</span>

<span class="c1"># Downloading the PDB file</span>
<span class="n">web_address</span> <span class="o">=</span> <span class="s2">&quot;https://files.rcsb.org/view/101M.pdb&quot;</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span>
    <span class="n">web_address</span><span class="p">,</span>
    <span class="n">WORKING_DIR</span> <span class="o">/</span> <span class="s2">&quot;101m.pdb&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Of course, feel free to adapt this to another <code class="docutils literal notranslate"><span class="pre">.pdb</span></code> file (as long as you place it in <code class="docutils literal notranslate"><span class="pre">./tmp</span></code>). To aid this generalization, weâ€™ll define a <code class="docutils literal notranslate"><span class="pre">pdb_name</span></code> variable, which will correspond to <code class="docutils literal notranslate"><span class="pre">101m</span></code> in our example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># In case you choose a different pdb, you can change the name here</span>
<span class="n">pdb_name</span> <span class="o">=</span> <span class="s2">&quot;101m&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="repairing-the-file">
<h2>Repairing the file<a class="headerlink" href="#repairing-the-file" title="Permalink to this heading">#</a></h2>
<p>The common way to process a pdb for mutation is to start by repairing the file using the <code class="docutils literal notranslate"><span class="pre">RepairPDB</span></code> command inside FoldX. Check <span class="xref myst">their documentation</span> for more details.</p>
<p>We will check whether the file exists (for future re-runs), since the process is a little bit time-consumig (&gt;400sec).</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">subprocess</span>

<span class="c1"># Building the command for repairing the wildtype PDB</span>
<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">WORKING_DIR</span> <span class="o">/</span> <span class="s2">&quot;101m_Repair.pdb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="n">repair_cmd</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">PATH_TO_FOLDX_FILES</span> <span class="o">/</span> <span class="s2">&quot;foldx&quot;</span><span class="p">),</span>
        <span class="s2">&quot;--pdb&quot;</span><span class="p">,</span>
        <span class="s2">&quot;101m.pdb&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--command&quot;</span><span class="p">,</span>
        <span class="s2">&quot;RepairPDB&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--water&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-CRYSTAL&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--pH&quot;</span><span class="p">,</span>
        <span class="s2">&quot;7.0&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="c1"># Running the repair command</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">repair_cmd</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">WORKING_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>After we run this repair process, this is the tree structure of the <code class="docutils literal notranslate"><span class="pre">tmp</span></code> working directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>â””â”€â”€ tmp
    â”œâ”€â”€ 101m.pdb
    â”œâ”€â”€ 101m_Repair.fxout
    â”œâ”€â”€ 101m_Repair.pdb
    â”œâ”€â”€ Unrecognized_molecules.txt
    â””â”€â”€ rotabase.txt
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">101m_Repair.pdb</span></code> is the main output of this <code class="docutils literal notranslate"><span class="pre">RepairPDB</span></code>, and we will use it onwards.</p>
<div class="dropdown admonition">
<p class="admonition-title">What are the other files?</p>
<p>[TODO: complete].</p>
</div>
<p>Now, letâ€™s parse this file and inspect it.</p>
</section>
<section id="parsing-the-repaired-wildtype">
<h2>Parsing the repaired wildtype<a class="headerlink" href="#parsing-the-repaired-wildtype" title="Permalink to this heading">#</a></h2>
<p>We can easily load up the structure using <code class="docutils literal notranslate"><span class="pre">biopython</span></code>:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">PDB</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">PDB</span><span class="o">.</span><span class="n">PDBParser</span><span class="p">()</span>
<span class="n">structure</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="s2">&quot;pdb&quot;</span><span class="p">,</span> <span class="n">WORKING_DIR</span> <span class="o">/</span> <span class="s2">&quot;101m_Repair.pdb&quot;</span><span class="p">)</span>
<span class="n">residues</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">get_residues</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>At this point, the list <code class="docutils literal notranslate"><span class="pre">residues</span></code> is full of <code class="docutils literal notranslate"><span class="pre">Bio.PDB.Residue</span></code>s. These contain all the relevant information of each residue. Letâ€™s dive into some of the attributes and methods of the first one:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_residue</span> <span class="o">=</span> <span class="n">residues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Residue&#39;s name: </span><span class="si">{</span><span class="n">first_residue</span><span class="o">.</span><span class="n">resname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The sequence index: </span><span class="si">{</span><span class="n">first_residue</span><span class="o">.</span><span class="n">id</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chain id: </span><span class="si">{</span><span class="n">first_residue</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Residue&#39;s name: MET
The sequence index: 0
Chain id: A
</pre></div>
</div>
</div>
</div>
<p>As you can see, the residue is specified as the 3-letter code. We can extract the 1-letter code using <code class="docutils literal notranslate"><span class="pre">Bio.SeqUtils</span></code>â€™ <code class="docutils literal notranslate"><span class="pre">seq1</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Bio.SeqUtils</span> <span class="kn">import</span> <span class="n">seq1</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Residue as one letter: </span><span class="si">{</span><span class="n">seq1</span><span class="p">(</span><span class="n">first_residue</span><span class="o">.</span><span class="n">resname</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Residue as one letter: M
</pre></div>
</div>
</div>
</div>
<p>These are all the ingredients we will need for defining mutations. This is what we focus on next.</p>
</section>
<section id="defining-mutations">
<h2>Defining mutations<a class="headerlink" href="#defining-mutations" title="Permalink to this heading">#</a></h2>
<p>As they say in <span class="xref myst">their documentation</span>, we need to specify mutations by either providing the mutated 1-letter sequence, or by specifying a list of individual mutations.</p>
<p>In this tutorial, we will show how to work with the latter version. Mutations are defined in an <code class="docutils literal notranslate"><span class="pre">individual_list.txt</span></code> file. Each row of this file has the following structure:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">row</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">original_residue</span><span class="si">}{</span><span class="n">chain_id</span><span class="si">}{</span><span class="n">position_in_sequence</span><span class="si">}{</span><span class="n">mutant_residue</span><span class="si">}</span><span class="s2">;&quot;</span>
</pre></div>
</div>
<p>For our running example, we know that</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">original_residue</span> <span class="pre">=</span> <span class="pre">seq1(first_residue.resname)</span></code> is <code class="docutils literal notranslate"><span class="pre">M</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chain_id</span> <span class="pre">=</span> <span class="pre">first_residue.get_parent().id</span></code> is <code class="docutils literal notranslate"><span class="pre">A</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">position_in_sequence</span> <span class="pre">=</span> <span class="pre">first_residue.id[1]</span></code> is <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mutant_residue</span></code> is for us to choose, letâ€™s say <code class="docutils literal notranslate"><span class="pre">G</span></code> (i.e. Glycine (?)).</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Be careful with <code class="docutils literal notranslate"><span class="pre">position_in_sequence</span></code>. In general, this position is <strong>not</strong> the position in the list of residues. The sure-fire way of getting it is, as we did, by accessing <code class="docutils literal notranslate"><span class="pre">.id[1]</span></code>.</p>
</div>
<p>Letâ€™s define this mutation in a way thatâ€™s easily modifiable. We can create a <code class="docutils literal notranslate"><span class="pre">mutation_list</span></code> with the position in the residue list we want to modify, and to which residue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mutation_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;residue_idx&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="s2">&quot;G&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can create the <code class="docutils literal notranslate"><span class="pre">individual_list.txt</span></code> file inside our working directory:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">WORKING_DIR</span> <span class="o">/</span> <span class="s2">&quot;individual_list.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">mutation</span> <span class="ow">in</span> <span class="n">mutation_list</span><span class="p">:</span>
        <span class="c1"># We get the initial residue from the PDB file, this is a Residue type.</span>
        <span class="c1"># You can check the documentation of these inside Biopython.</span>
        <span class="n">residue</span> <span class="o">=</span> <span class="n">residues</span><span class="p">[</span><span class="n">mutation</span><span class="p">[</span><span class="s2">&quot;residue_idx&quot;</span><span class="p">]]</span>

        <span class="c1"># The original residue lies in residue.resname. This is the 3-letter code.</span>
        <span class="c1"># To tranform it into the 1-letter code, we use seq1 from Bio.SeqUtils.</span>
        <span class="n">original_residue</span> <span class="o">=</span> <span class="n">seq1</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">resname</span><span class="p">)</span>

        <span class="c1"># We can read the position as the second position of the ID:</span>
        <span class="c1"># residue.id = (&#39; &#39;, position_in_chain, &#39; &#39;)</span>
        <span class="n">position</span> <span class="o">=</span> <span class="n">residue</span><span class="o">.</span><span class="n">id</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># The chain ID can be read from the parent of the residue</span>
        <span class="n">chain_id</span> <span class="o">=</span> <span class="n">residue</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span><span class="o">.</span><span class="n">id</span>

        <span class="c1"># The line we need to write, then, is:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">original_residue</span><span class="si">}{</span><span class="n">chain_id</span><span class="si">}{</span><span class="n">position</span><span class="si">}{</span><span class="n">mutation</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">;&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The contents of <code class="docutils literal notranslate"><span class="pre">indiviual_list.txt</span></code> then are:</p>
<div class="highlight-txt notranslate"><div class="highlight"><pre><span></span>MA0G;

</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is important that the list of mutations is called <code class="docutils literal notranslate"><span class="pre">individual_list.txt</span></code>. Otherwise, <code class="docutils literal notranslate"><span class="pre">foldx</span></code> wonâ€™t be able to process it.</p>
</div>
</section>
<section id="computing-the-mutation-s-energy">
<h2>Computing the mutationâ€™s energy<a class="headerlink" href="#computing-the-mutation-s-energy" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">foldx</span></code>â€™s <code class="docutils literal notranslate"><span class="pre">BuildModel</span></code> command allows us to compute (among several things) the total Gibbs energy of both the original wild type, as well as mutations of it.</p>
<p>The command to run goes as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">foldx_cmd</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nb">str</span><span class="p">(</span><span class="n">PATH_TO_FOLDX_FILES</span> <span class="o">/</span> <span class="s2">&quot;foldx&quot;</span><span class="p">),</span>
    <span class="s2">&quot;--pdb&quot;</span><span class="p">,</span>
    <span class="s2">&quot;101m_Repair.pdb&quot;</span><span class="p">,</span>
    <span class="s2">&quot;--command&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BuildModel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;--mutant-file&quot;</span><span class="p">,</span>
    <span class="nb">str</span><span class="p">(</span><span class="n">WORKING_DIR</span> <span class="o">/</span> <span class="s2">&quot;individual_list.txt&quot;</span><span class="p">),</span>
    <span class="s2">&quot;--water&quot;</span><span class="p">,</span>
    <span class="s2">&quot;-CRYSTAL&quot;</span><span class="p">,</span>
    <span class="s2">&quot;--pH&quot;</span><span class="p">,</span>
    <span class="s2">&quot;7.0&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>which can be run using <code class="docutils literal notranslate"><span class="pre">subprocess</span></code>â€™ <code class="docutils literal notranslate"><span class="pre">run</span></code> method:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">foldx_cmd</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">WORKING_DIR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ********************************************
   ***                                      ***
   ***             FoldX 5 (c)            ***
   ***                                      ***
   ***     code by the FoldX Consortium     ***
   ***                                      ***
   ***     Jesper Borg, Frederic Rousseau   ***
   ***    Joost Schymkowitz, Luis Serrano   ***
   ***    Peter Vanhee, Erik Verschueren    ***
   ***     Lies Baeten, Javier Delgado      ***
   ***       and Francois Stricher          ***
   *** and any other of the 9! permutations ***
   ***   based on an original concept by    ***
   ***   Raphael Guerois and Luis Serrano   ***
   ********************************************

1 models read: 101m_Repair.pdb
1 models read: 101m_Repair.pdb
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BackHbond       =               -142.58
SideHbond       =               -48.61
Energy_VdW      =               -179.63
Electro         =               -8.33
Energy_SolvP    =               245.28
Energy_SolvH    =               -238.89
Energy_vdwclash =               3.42
energy_torsion  =               6.70
backbone_vdwclash=              158.16
Entropy_sidec   =               105.87
Entropy_mainc   =               231.69
water bonds     =               0.00
helix dipole    =               -8.75
loop_entropy    =               0.00
cis_bond        =               0.00
disulfide       =               0.00
kn electrostatic=               0.00
partial covalent interactions = 0.00
Energy_Ionisation =             1.56
Entropy Complex =               0.00
-----------------------------------------------------------
Total          = 				  -32.28
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BackHbond       =               -142.58
SideHbond       =               -48.61
Energy_VdW      =               -179.63
Electro         =               -8.33
Energy_SolvP    =               245.28
Energy_SolvH    =               -238.89
Energy_vdwclash =               3.42
energy_torsion  =               6.70
backbone_vdwclash=              158.16
Entropy_sidec   =               105.87
Entropy_mainc   =               231.69
water bonds     =               0.00
helix dipole    =               -8.75
loop_entropy    =               0.00
cis_bond        =               0.00
disulfide       =               0.00
kn electrostatic=               0.00
partial covalent interactions = 0.00
Energy_Ionisation =             1.56
Entropy Complex =               0.00
-----------------------------------------------------------
Total          = 				  -32.28

Starting BuildModel
Reading MA0G;
Residue to Mutate META0 has residue index 0
Mutating residue = META0 into GLY
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Your file run OK
End time of FoldX: Wed Feb  7 16:44:52 2024
Total time spend: 22.96 seconds.
validated file &quot;101m_Repair_1.pdb&quot; =&gt; successfully finished
Cleaning BuildModel...DONE
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CompletedProcess(args=[&#39;/Users/sjt972/foldx/foldx&#39;, &#39;--pdb&#39;, &#39;101m_Repair.pdb&#39;, &#39;--command&#39;, &#39;BuildModel&#39;, &#39;--mutant-file&#39;, &#39;/Users/sjt972/Projects/poli-docs/docs/poli-docs/understanding_foldx/01-single-mutation-using-foldx/tmp/individual_list.txt&#39;, &#39;--water&#39;, &#39;-CRYSTAL&#39;, &#39;--pH&#39;, &#39;7.0&#39;], returncode=0)
</pre></div>
</div>
</div>
</details>
</div>
<p>After running this command, 6 new files are created in our working directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>â””â”€â”€ tmp
    â”œâ”€â”€ 101m.pdb
    â”œâ”€â”€ 101m_Repair.fxout
    â”œâ”€â”€ 101m_Repair.pdb
    â”œâ”€â”€ 101m_Repair_1.pdb           # &lt;--
    â”œâ”€â”€ Average_101m_Repair.fxout   # &lt;--
    â”œâ”€â”€ Dif_101m_Repair.fxout       # &lt;--
    â”œâ”€â”€ PdbList_101m_Repair.fxout   # &lt;--
    â”œâ”€â”€ Raw_101m_Repair.fxout       # &lt;--
    â”œâ”€â”€ Unrecognized_molecules.txt
    â”œâ”€â”€ WT_101m_Repair_1.pdb        # &lt;--
    â”œâ”€â”€ individual_list.txt
    â””â”€â”€ rotabase.txt
</pre></div>
</div>
<p>Of these, the resulting energy can be found in the last two lines of <code class="docutils literal notranslate"><span class="pre">Raw_{pdb_name}_Repair.fxout</span></code>, which form a table with several more quantities. Letâ€™s create a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The details of these can be found in:</span>
<span class="c1"># https://foldxsuite.crg.eu/command/BuildModel</span>

<span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Pdb&quot;</span><span class="p">,</span>
    <span class="s2">&quot;total energy&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Backbone Hbond&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sidechain Hbond&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Van der Waals&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Electrostatics&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Solvation Polar&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Solvation Hydrophobic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Van der Waals clashes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;entropy sidechain&quot;</span><span class="p">,</span>
    <span class="s2">&quot;entropy mainchain&quot;</span><span class="p">,</span>
    <span class="s2">&quot;sloop_entropy&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;mloop_entropy&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cis_bond&quot;</span><span class="p">,</span>
    <span class="s2">&quot;torsional clash&quot;</span><span class="p">,</span>
    <span class="s2">&quot;backbone clash&quot;</span><span class="p">,</span>
    <span class="s2">&quot;helix dipole&quot;</span><span class="p">,</span>
    <span class="s2">&quot;water bridge&quot;</span><span class="p">,</span>
    <span class="s2">&quot;disulfide&quot;</span><span class="p">,</span>
    <span class="s2">&quot;electrostatic kon&quot;</span><span class="p">,</span>
    <span class="s2">&quot;partial covalent bonds&quot;</span><span class="p">,</span>
    <span class="s2">&quot;energy Ionisation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Entropy Complex&quot;</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">WORKING_DIR</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;Raw_</span><span class="si">{</span><span class="n">pdb_name</span><span class="si">}</span><span class="s2">_Repair.fxout&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

<span class="c1"># The important data is in the last two lines</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]],</span>
    <span class="n">columns</span><span class="o">=</span><span class="n">column_names</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/l3/qk9dx6g958765kmn_2wn34t00000gn/T/ipykernel_25734/1758354106.py:1: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd
</pre></div>
</div>
</div>
</div>
<p>Of all these columns, we are interested in the <code class="docutils literal notranslate"><span class="pre">total</span> <span class="pre">energy</span></code> (<em>the predicted overall stability of the protein</em>, according to <a class="reference external" href="https://foldxsuite.crg.eu/command/BuildModel"><code class="docutils literal notranslate"><span class="pre">foldx</span></code></a>). Letâ€™s check what the total energy was for both of these:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Pdb&quot;</span><span class="p">,</span> <span class="s2">&quot;total energy&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pdb</th>
      <th>total energy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>101m_Repair_1.pdb</td>
      <td>-31.7457</td>
    </tr>
    <tr>
      <th>1</th>
      <td>WT_101m_Repair_1.pdb</td>
      <td>-34.3436</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">foldx</span></code>â€™s notation, the row at index 0 corresponds to the mutated version of the wild type (which appears at index 1).</p>
</section>
<section id="computing-the-sasa-score">
<h2>Computing the SASA score<a class="headerlink" href="#computing-the-sasa-score" title="Permalink to this heading">#</a></h2>
<p>SASA stands for <em>solvent-accessible surface area</em>. An algorithm for computing this value was described in <span id="id1">[<a class="reference internal" href="../../bibliography.html#id3" title="A. Shrake and J.A. Rupley. Environment and exposure to solvent of protein atoms. lysozyme and insulin. Journal of Molecular Biology, 79(2):351â€“371, Sep 1973. doi:10.1016/0022-2836(73)90011-9.">Shrake and Rupley, 1973</a>]</span>.</p>
<p>Computing it is pretty easy now that we have both the PDB for the wild type and for the mutated molecule. <code class="docutils literal notranslate"><span class="pre">Biopython</span></code> has all the functionality available:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Bio.PDB</span> <span class="kn">import</span> <span class="n">SASA</span>

<span class="c1"># Let&#39;s load up the structure again, for both the wildtype and the mutant</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">PDB</span><span class="o">.</span><span class="n">PDBParser</span><span class="p">(</span><span class="n">QUIET</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">wt_structure</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="s2">&quot;pdb&quot;</span><span class="p">,</span> <span class="n">WORKING_DIR</span> <span class="o">/</span> <span class="s2">&quot;101m_Repair.pdb&quot;</span><span class="p">)</span>
<span class="n">mut_structure</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="s2">&quot;pdb1&quot;</span><span class="p">,</span> <span class="n">WORKING_DIR</span> <span class="o">/</span> <span class="s2">&quot;101m_Repair_1.pdb&quot;</span><span class="p">)</span>

<span class="c1"># Now, we can create a SASA computer</span>
<span class="n">sasa</span> <span class="o">=</span> <span class="n">SASA</span><span class="o">.</span><span class="n">ShrakeRupley</span><span class="p">()</span>

<span class="c1"># We can attach, to each structure, its SASA</span>
<span class="n">sasa</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">wt_structure</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>
<span class="n">sasa</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">mut_structure</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wildtype SASA: </span><span class="si">{</span><span class="n">wt_structure</span><span class="o">.</span><span class="n">sasa</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mutant SASA: </span><span class="si">{</span><span class="n">mut_structure</span><span class="o">.</span><span class="n">sasa</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Wildtype SASA: 8407.731560227876
Mutant SASA: 8439.063468009845
</pre></div>
</div>
</div>
</div>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">#</a></h2>
<p>This short tutorial shows how to use the binaries of <code class="docutils literal notranslate"><span class="pre">foldx</span></code> to measure the impact of a mutation on a wild typeâ€™s predicted energy. To do so, we</p>
<ol class="arabic simple">
<li><p>repaired the <code class="docutils literal notranslate"><span class="pre">.pdb</span></code> we downloaded from the database,</p></li>
<li><p>defined a desired mutation using an <code class="docutils literal notranslate"><span class="pre">individual_list.txt</span></code> file,</p></li>
<li><p>used <code class="docutils literal notranslate"><span class="pre">foldx</span></code>â€™s BuildModel command, passing this list of desired mutations.</p></li>
<li><p>computed both the stability and the SASA of the wild type and its mutation.</p></li>
</ol>
<p>These are quantities we want to optimize: the lesser the energy, the stabler a protein might be, and higher SASA correlates with e.g. length of fluorescence in certain proteins. Indeed, these are the quantities described and optimized one of the tasks presented in <a class="reference external" href="https://github.com/samuelstanton/lambo">LaMBO</a> <span id="id2">[<a class="reference internal" href="../../bibliography.html#id2" title="Samuel Stanton, Wesley Maddox, Nate Gruver, Phillip Maffettone, Emily Delaney, Peyton Greenside, and Andrew Gordon Wilson. Accelerating bayesian optimization for biological sequence design with denoising autoencoders. arXiv preprint arXiv:2203.12742, 2022.">Stanton <em>et al.</em>, 2022</a>]</span>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./understanding_foldx/01-single-mutation-using-foldx"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../00-installing-foldx.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Installing <code class="docutils literal notranslate"><span class="pre">foldx</span></code></p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-folders-and-files">Setting up folders and files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-a-pdb-file">Downloading a <code class="docutils literal notranslate"><span class="pre">PDB</span></code> file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#repairing-the-file">Repairing the file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parsing-the-repaired-wildtype">Parsing the repaired wildtype</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-mutations">Defining mutations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-mutation-s-energy">Computing the mutationâ€™s energy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-sasa-score">Computing the SASA score</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Center for Basic Machine Learning Research in Life Science
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>